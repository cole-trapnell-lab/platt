% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/assembly_utils.R
\name{fit_mt_models}
\alias{fit_mt_models}
\title{Fit Models for Multi-Timepoint Perturbation Analysis}
\usage{
fit_mt_models(
  cds,
  sample_group,
  cell_group,
  main_model_formula_str = NULL,
  num_time_breaks = 3,
  nuisance_model_formula_str = "~1",
  ctrl_ids = NULL,
  mt_ids = NULL,
  sparsity_factor = 1,
  vhat_method = "bootstrap",
  interval_col = "timepoint",
  perturbation_col = "knockout",
  batch_col = "expt",
  newdata = tibble(),
  start_time = NULL,
  stop_time = NULL,
  interval_step = 2,
  log_abund_detection_thresh = -5,
  q_val = 0.1,
  edge_allowlist = NULL,
  edge_denylist = NULL,
  keep_cds = TRUE,
  keep_ccs = TRUE,
  verbose = FALSE,
  num_threads = 1,
  backend = "nlopt",
  penalize_by_distance = TRUE,
  independent_spline_for_ko = TRUE,
  num_bootstraps = 10,
  embryo_size_factors = NULL,
  batches_excluded_from_assembly = c()
)
}
\arguments{
\item{cds}{A cell dataset object (cds) containing the data to be analyzed.}

\item{sample_group}{A character string specifying the sample grouping variable.}

\item{cell_group}{A character string specifying the cell grouping variable.}

\item{main_model_formula_str}{A character string specifying the main model formula. Default is NULL.}

\item{num_time_breaks}{An integer specifying the number of time breaks for the analysis. Default is 3.}

\item{nuisance_model_formula_str}{A character string specifying the nuisance model formula. Default is "~1".}

\item{ctrl_ids}{A vector of control identifiers. Default is NULL.}

\item{mt_ids}{A vector of multi-timepoint identifiers. Default is NULL.}

\item{sparsity_factor}{A numeric value for sparsity adjustment. Default is 1.}

\item{vhat_method}{A character string specifying the method for variance estimation. Default is "bootstrap".}

\item{interval_col}{A character string specifying the column name for time intervals. Default is "timepoint".}

\item{perturbation_col}{A character string specifying the column name for perturbation identifiers. Default is "knockout".}

\item{batch_col}{A character string specifying the column name for batch identifiers. Default is "expt".}

\item{newdata}{A tibble containing new data for prediction. Default is an empty tibble.}

\item{start_time}{A numeric value specifying the start time for the analysis. Default is NULL.}

\item{stop_time}{A numeric value specifying the stop time for the analysis. Default is NULL.}

\item{interval_step}{An integer specifying the step size for time intervals. Default is 2.}

\item{log_abund_detection_thresh}{A numeric threshold for log abundance detection. Default is -5.}

\item{q_val}{A numeric value specifying the q-value threshold for significance. Default is 0.1.}

\item{edge_allowlist}{A vector of edges to allow in the analysis. Default is NULL.}

\item{edge_denylist}{A vector of edges to deny in the analysis. Default is NULL.}

\item{keep_cds}{A logical value indicating whether to keep the cds object in the output. Default is TRUE.}

\item{keep_ccs}{A logical value indicating whether to keep the cell count set (ccs) in the output. Default is TRUE.}

\item{verbose}{A logical value indicating whether to print verbose messages. Default is FALSE.}

\item{num_threads}{An integer specifying the number of threads to use. Default is 1.}

\item{backend}{A character string specifying the backend to use for optimization. Default is "nlopt".}

\item{penalize_by_distance}{A logical value indicating whether to penalize by distance in the analysis. Default is TRUE.}

\item{independent_spline_for_ko}{A logical value indicating whether to use independent splines for knockouts. Default is TRUE.}

\item{num_bootstraps}{An integer specifying the number of bootstraps for variance estimation. Default is 10.}

\item{embryo_size_factors}{A named vector of size factors for embryos. Default is NULL.}

\item{batches_excluded_from_assembly}{A vector of batch identifiers to exclude from the analysis. Default is an empty vector.}
}
\value{
A tibble containing the fitted perturbation models and associated metadata.
}
\description{
This function fits models for analyzing multi-timepoint perturbation data
using a cell dataset (cds). It allows for the specification of various
parameters to customize the analysis, including the main model formula,
nuisance model formula, and perturbation-specific settings.
}
\details{
This function performs multi-timepoint perturbation analysis by
fitting models to cell count data. It supports various customization options
for handling batch effects, time intervals, and perturbation-specific settings.
The function also allows for the inclusion of user-supplied size factors and
the exclusion of specific batches from the analysis.
}
\examples{
# Example usage:
# fit_mt_models(cds, sample_group = "sample", cell_group = "cell_type")

}
